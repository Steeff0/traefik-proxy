version: "3.9"
services:

  # DO NOT USE IN PRODUCTION
  proxy:
    container_name: traefik
    image: traefik:brie # the brie tag refers to v2.4
    restart: unless-stopped
    command:
      - --global.checkNewVersion=true
      - --global.sendAnonymousUsage=false
      - --entryPoints.http.address=:80
      - --entryPoints.traefik.address=:8080
      - --api=true
      - --log=true
      - --log.level=INFO
      - --accessLog=true
      - --accessLog.filePath=/var/log/traefik_access.log
      - --accessLog.bufferingSize=100
      - --accessLog.filters.statusCodes=400-499
      - --providers.docker=true
      - --providers.docker.endpoint=unix:///var/run/docker.sock
      - --providers.docker.exposedByDefault=false
      - --providers.docker.network=local-dev
      - --providers.docker.swarmMode=false
    networks:
      - local-dev
    ports:
      - 80:80
      - 8080:8080
    ports:
      - target: 80
        published: 80
        protocol: tcp
        mode: host
      - target: 8080
        published: 8888
        protocol: tcp
        mode: host
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro

networks:
  local-dev:
